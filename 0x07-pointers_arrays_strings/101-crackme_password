#include <openssl/evp.h>

bool SHA256Hash(const char* buf, size_t buflen, char* res, size_t reslen)
{
	if (reslen >= 32)
	{
        	EVP_MD_CTX mdctx;

        	EVP_MD_CTX_init(&mdctx);

        	EVP_DigestInit_ex(&mdctx, EVP_sha256(), NULL);
        	EVP_DigestUpdate(&mdctx, buf, buflen);
        	EVP_DigestFinal_ex(&mdctx, res, &len);

        	EVP_MD_CTX_cleanup(&mdctx);

        	return (len == 32);
	}

	return false;
}

